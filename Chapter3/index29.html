<!DOCTYPE html>
<html lang="en">
		<head>
		<meta charset="UTF-8">
		<title>Chapter 3:: AJAX and JSON</title>
		<style>
/*Include a web font from Google*/
@import url(http://fonts.googleapis.com/css?family=Denk+One);
/*Basic CSS for positioning*/
body {
	font-family: 'Denk One', sans-serif;
}
#frame {
	width: 500px;
	margin: 125px auto auto auto;
	border: solid 1px #CCC;
	box-shadow: 0 0 10px #CCC;
	border-radius: 5px;
	background-color: #FFF;
}
.search .header {
	margin: 25px;
	text-align: center;
}
.search .header input {
	width: 350px;
}
.suggest-input input{
  width: 440px;
}
.suggest-input{
  position: relative;
  padding: 25px;
}
/*SUGGESTION LIST STYLES*/
.suggest-list{
  position: absolute;
  width: 424px;
  background-color: #f1f1f1;
  margin: 0;
  left: 25px;
  top: 50px;
  z-index: 100;
  display: none;
  list-style: none;
  padding: 10px;
}
#results-holder {
	min-height: 200px;
}
.loading {
	text-align: center;
	line-height: 30px;
	display: none;
}
.loading-holder {
	height: 30px;
}
/*Styling for the results list*/
#results-list {
	margin: 0;
	padding: 0;
	list-style: none;
}
#results-list li {
	line-height: 30px;
	border-bottom: solid 1px #CCC;
	padding: 5px 5px 5px 10px;
	color: #333;
}
/*Remove the Border from the last list element so it doesn't class with the frame border*/
#results-list li:last-child {
	border: none;
}
/*Style the no results list item*/
#results-list .no-results {
	text-align: center;
	font-weight: bold;
	font-size: 14px;
}
</style>
		<script src="js/jquery.min.js"></script>
		<script>
		$(function(){
      $('#text').keyup(function() {
        if($('#text').val().length > 2){
        $('.suggest-list').show();
        makeSuggestion();
        } else{
        $('.suggest-list').hide();
        }
      });
      $('.search').on('click', '.suggestion', function() {
        $('#text').val($(this).html());
      });
    });

function makeSuggestion() {
  var searchText = $('#text').val();
  //Rehide the search results
  $('.suggest-list').empty();
  $.ajax({
    url: 'search.php',
    type: 'POST',
    data: {
      'text': searchText
    },
    beforeSend: function(){
      $('.suggest-list').append("<li class='loading'>Loading...</li>");
    },
    success: function(data) {
      if (data.success) {
        $('.suggest-list').empty();
        if(data.results.length > 0) {
          $.each(data.results, function(){
            $('.suggest-list').append("<li><a href='#' class='suggestion'>" + this.title + "</a></li>");
          });
        } else {
          $('.suggest-list').append("<li class='no-results'>Nothing to suggest...</li>");
        }
      } else {
        //Display the error message
        alert(data.error);
      }
    }
  });
}

		</script>
		</head>
		<body>
        <div id="frame">
          <div class="search">
            <div class="header">
              <h1>Chapter 3:: Search Feature</h1>
            </div>
            <div class="suggest-input">
              <input type="text" id="text">
              <ul class="suggest-list"></ul>
            </div>
          </div>
        </div>
</body>
</html>